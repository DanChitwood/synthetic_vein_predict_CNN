Geometric Morphometric Analysis and Synthetic Data Generation
Leaf shape data, comprising both vein and blade coordinate landmarks, were prepared for geometric morphometric analysis. Each leaf's coordinate set was initially reshaped into a two-dimensional array by concatenating vein and blade coordinates. A Generalized Procrustes Analysis (GPA) was then performed to remove non-shape variation (position, scale, and orientation), yielding a mean shape and a set of Procrustes-aligned shapes.

Principal Component Analysis (PCA) was subsequently applied to the flattened, Procrustes-aligned shape coordinates to reduce dimensionality and capture the primary modes of shape variation. The number of principal components retained for analysis was dynamically determined by the minimum dimension of the input data, effectively encompassing the maximum possible variance (i.e., min(number of samples, number of flattened features)).

For the purpose of data augmentation, a Synthetic Minority Over-sampling Technique (SMOTE)-like algorithm was implemented within the PCA morphospace. This method generates synthetic samples by interpolating between existing data points and their k-nearest neighbors. For each synthetic sample, a random original sample is selected, and one of its k-nearest neighbors (excluding itself, with k typically set to 3 or 5) is chosen. A random interpolation factor (rho) between 0 and 1 is then used to create a new point along the line segment connecting the selected sample and its neighbor. The generated synthetic PCA scores can then be reconstructed back into the original 2D leaf coordinate space using the inverse PCA transformation (the PCA mean and principal components matrix).

All critical data, including the calculated GPA mean shape, the fitted PCA model parameters (components, mean, explained variance, and number of components), the original PCA scores, and their corresponding genotype labels, were persistently saved. These outputs were stored in a structured directory ../outputs/saved_leaf_model_data, utilizing HDF5 format for numerical arrays (PCA parameters, scores) and Python's pickle for the leaf_indices dictionary, which defines the anatomical segments of the leaf. This robust saving strategy ensures data integrity and facilitates the subsequent generation of synthetic leaf shapes for downstream applications, such as convolutional neural network (CNN) training.