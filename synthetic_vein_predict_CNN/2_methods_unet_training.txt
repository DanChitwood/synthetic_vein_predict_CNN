Convolutional Neural Network Architecture and Training
A U-Net convolutional neural network (CNN) architecture was employed for the semantic segmentation of grapevine vein structures. The model was configured to accept two input channels: one for the blade's Euclidean Distance Transform (ECT) and another for the blade's binary mask. It outputs a single channel representing the predicted binary mask of the vein structure.

The network was trained using a combined loss function, consisting of Binary Cross-Entropy (BCE) Loss and Dice Loss, each weighted equally at 0.5. Optimization was performed using the Adam optimizer with a learning rate of 0.0005. Training was conducted over 100 epochs, utilizing a batch size of 16. The dataset was split into training and validation sets with an 80/20 ratio, respectively. Model performance was monitored on the validation set, and the best-performing model, as determined by the highest Dice Coefficient, was saved. All training processes were made reproducible by setting a global random seed to 42. The training leveraged available hardware acceleration, automatically selecting between MPS (Metal Performance Shaders), CUDA, or CPU.